<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>调用栈、堆、垃圾回收 | NoteBook</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/notebook/logo.png">
    <meta name="description" content="my notebook --xy">
    
    <link rel="preload" href="/notebook/assets/css/0.styles.feb86cda.css" as="style"><link rel="preload" href="/notebook/assets/js/app.d5d280cf.js" as="script"><link rel="preload" href="/notebook/assets/js/2.c59ea2be.js" as="script"><link rel="preload" href="/notebook/assets/js/11.1ba6addf.js" as="script"><link rel="prefetch" href="/notebook/assets/js/10.72515af1.js"><link rel="prefetch" href="/notebook/assets/js/12.8edd0917.js"><link rel="prefetch" href="/notebook/assets/js/13.42a10ed1.js"><link rel="prefetch" href="/notebook/assets/js/14.ec9584cf.js"><link rel="prefetch" href="/notebook/assets/js/15.f4656040.js"><link rel="prefetch" href="/notebook/assets/js/16.2b5011e7.js"><link rel="prefetch" href="/notebook/assets/js/17.a581b238.js"><link rel="prefetch" href="/notebook/assets/js/18.1151e99e.js"><link rel="prefetch" href="/notebook/assets/js/19.02e9495d.js"><link rel="prefetch" href="/notebook/assets/js/20.39f944a0.js"><link rel="prefetch" href="/notebook/assets/js/21.e830f85f.js"><link rel="prefetch" href="/notebook/assets/js/22.63a71e21.js"><link rel="prefetch" href="/notebook/assets/js/23.581079fc.js"><link rel="prefetch" href="/notebook/assets/js/3.0acca8a1.js"><link rel="prefetch" href="/notebook/assets/js/4.278935cc.js"><link rel="prefetch" href="/notebook/assets/js/5.d2a33903.js"><link rel="prefetch" href="/notebook/assets/js/6.ca28aea6.js"><link rel="prefetch" href="/notebook/assets/js/7.0c4d68ce.js"><link rel="prefetch" href="/notebook/assets/js/8.17627da9.js"><link rel="prefetch" href="/notebook/assets/js/9.47008517.js">
    <link rel="stylesheet" href="/notebook/assets/css/0.styles.feb86cda.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notebook/" class="home-link router-link-active"><img src="/notebook/logo.png" alt="NoteBook" class="logo"> <span class="site-name can-hide">NoteBook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/notebook/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/notebook/algorithm/one.html" class="nav-link">
  Algorithm
</a></div><div class="nav-item"><a href="/notebook/browser/one.html" class="nav-link">
  Browser
</a></div><div class="nav-item"><a href="/notebook/vue/one.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/notebook/javascript/" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/notebook/css/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/notebook/network/" class="nav-link">
  Network
</a></div><div class="nav-item"><a href="/notebook/tools/one.html" class="nav-link">
  工程化
</a></div><div class="nav-item"><a href="/notebook/others/" class="nav-link">
  其他
</a></div><div class="nav-item"><a href="https://github.com/HuaYuan92/notebook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/notebook/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/notebook/algorithm/one.html" class="nav-link">
  Algorithm
</a></div><div class="nav-item"><a href="/notebook/browser/one.html" class="nav-link">
  Browser
</a></div><div class="nav-item"><a href="/notebook/vue/one.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/notebook/javascript/" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/notebook/css/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/notebook/network/" class="nav-link">
  Network
</a></div><div class="nav-item"><a href="/notebook/tools/one.html" class="nav-link">
  工程化
</a></div><div class="nav-item"><a href="/notebook/others/" class="nav-link">
  其他
</a></div><div class="nav-item"><a href="https://github.com/HuaYuan92/notebook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/notebook/algorithm/one.html" class="sidebar-link">复杂度</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/algorithm/one.html#一、为什么引入复杂度分析" class="sidebar-link">一、为什么引入复杂度分析</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/one.html#二、如何表示复杂度" class="sidebar-link">二、如何表示复杂度</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/one.html#三、时间复杂度" class="sidebar-link">三、时间复杂度</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/one.html#四、空间复杂度" class="sidebar-link">四、空间复杂度</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/one.html#五、平均时间复杂度" class="sidebar-link">五、平均时间复杂度</a></li></ul></li><li><a href="/notebook/algorithm/two.html" class="sidebar-link">数组</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/algorithm/two.html#一、数组-基础" class="sidebar-link">一、数组（基础）</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/two.html#二、javascript-中-数组可以保存不同类型值" class="sidebar-link">二、JavaScript 中，数组可以保存不同类型值</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/two.html#三、javascript-中-数组的存储" class="sidebar-link">三、JavaScript 中，数组的存储</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/two.html#四、javascript-中-数组的动态扩容与减容-fastelements" class="sidebar-link">四、JavaScript 中，数组的动态扩容与减容（FastElements）</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/two.html#五、解答开篇问题" class="sidebar-link">五、解答开篇问题</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/two.html#六、最后附赠一道前端面试题-腾讯-数组扁平化、去重、排序" class="sidebar-link">六、最后附赠一道前端面试题（腾讯）：数组扁平化、去重、排序</a></li></ul></li><li><a href="/notebook/algorithm/three.html" class="sidebar-link">LRU算法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/algorithm/three.html#一、lru-缓存淘汰策略" class="sidebar-link">一、LRU 缓存淘汰策略</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/three.html#二、lru-在-keep-alive-vue-上的实现" class="sidebar-link">二、LRU 在 keep-alive (Vue) 上的实现</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/three.html#三、leetcode-lru-缓存机制" class="sidebar-link">三、leetcode：LRU 缓存机制</a></li></ul></li><li><a href="/notebook/algorithm/four.html" class="sidebar-link">链表</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/algorithm/four.html#一、单链表" class="sidebar-link">一、单链表</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/four.html#二、双链表" class="sidebar-link">二、双链表</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/four.html#三、循环单链表-循环双链表" class="sidebar-link">三、循环单链表/循环双链表</a></li></ul></li><li><a href="/notebook/algorithm/five.html" aria-current="page" class="active sidebar-link">栈、堆、垃圾回收）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#一、-栈" class="sidebar-link">一、 栈</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#二、代码实现" class="sidebar-link">二、代码实现</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#三、浏览器中-js-运行机制" class="sidebar-link">三、浏览器中 JS 运行机制</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#四、调用栈" class="sidebar-link">四、调用栈</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#五、js-内存机制-栈-基本类型、引言类型地址-与堆-引用类型数据" class="sidebar-link">五、JS 内存机制：栈（基本类型、引言类型地址）与堆（引用类型数据）</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#六、总结" class="sidebar-link">六、总结</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#七、字节-leetcode155-最小栈-包含getmin函数的栈" class="sidebar-link">七、字节&amp;leetcode155：最小栈（包含getMin函数的栈）</a></li></ul></li><li><a href="/notebook/algorithm/six.html" class="sidebar-link">队列</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/algorithm/six.html#一、数据结构-队列" class="sidebar-link">一、数据结构：队列</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/six.html#二、双端队列-deque" class="sidebar-link">二、双端队列（Deque）</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="调用栈、堆、垃圾回收"><a href="#调用栈、堆、垃圾回收" class="header-anchor">#</a> 调用栈、堆、垃圾回收</h1> <p><a href="https://github.com/sisterAn/JavaScript-Algorithms/issues/24" target="_blank" rel="noopener noreferrer">github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>栈结构很简单，我们可以通过数组就能模拟出一个栈结构，但仅仅介绍栈结构就太不前端了，本节从栈结构开始延伸到浏览器中 JavaScript 运行机制，还有存储机制上用到的栈结构及相关数据结构，一文吃透所有的前端栈知识。</p> <p>以后再提到栈时，我们不再仅限于 LIFO 了，而是一个有深度的栈。<br>
这部分是前端进阶资深必备，如果你想打造高性能的前端应用，也需要了解这块，同时它也是面试的常见考察点。<br>
理解栈对于我们理解 JavaScript 语言至关重要，本文主要从以下几个方面介绍栈：</p> <p>首先介绍栈及代码实现
介绍 JavaScript 运行机制及栈在其中的应用
详细介绍调用栈及我们开发中如何利用调用栈
JS 内存机制：栈（基本类型、引用类型地址）与堆（引用类型数据）
最后来一份总结与字节&amp;leetcode刷题，实现最小栈
本节吃透栈原理，之后几天会每日一题，刷透栈题目，下面进入正文吧</p> <h2 id="一、-栈"><a href="#一、-栈" class="header-anchor">#</a> 一、 栈</h2> <p>栈是一种遵从后进先出 (LIFO / Last In First Out) 原则的有序集合。栈的操作主要有： push(e) (进栈)、 pop() (出栈)、 isEmpty() (判断是否是空栈)、 size() (栈大小)，以及 clear() 清空栈，具体实现也很简单。</p> <h2 id="二、代码实现"><a href="#二、代码实现" class="header-anchor">#</a> 二、代码实现</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Stack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">push</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    items<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> 
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">pop</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">return</span> items<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">isEmpty</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">return</span> items<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span> 
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">size</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">return</span> items<span class="token punctuation">.</span>length 
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">clear</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    items <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>查找：从栈头开始查找，时间复杂度为 O(n)</p> <p>插入或删除：进栈与出栈的时间复杂度为 O(1)</p> <h2 id="三、浏览器中-js-运行机制"><a href="#三、浏览器中-js-运行机制" class="header-anchor">#</a> 三、浏览器中 JS 运行机制</h2> <p>我们知道 JavaScript 是单线程的，所谓单线程，是指在 JavaScript 引擎中负责解释和执行 JavaScript 代码的线程唯一，同一时间上只能执行一件任务。</p> <p>为什么是单线程的喃？这是因为 JavaScript 可以修改 DOM 结构，如果 JavaScript 引擎线程不是单线程的，那么可以同时执行多段 JavaScript，如果这多段 JavaScript 都修改 DOM，那么就会出现 DOM 冲突。</p> <p>为了避免 DOM 渲染的冲突，可以采用单线程或者死锁，JavaScript 采用了单线程方案。</p> <p>但单线程有一个问题：如果任务队列里有一个任务耗时很长，导致这个任务后面的任务一直排队等待，就会发生页面卡死，严重影响用户体验。</p> <p>为了解决这个问题，JavaScript 将任务的执行模式分为两种：同步和异步。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 同步任务</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// 1// 同步任务</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token comment">// 异步任务</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'时间到'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>同步任务都在主线程（这里的主线程就是 JavaScript 引擎线程）上执行，会形成一个 调用栈 ，又称 **执行栈 **；</p> <p>除了主线程外，还有一个任务队列（也称消息队列），用于管理异步任务的 事件回调 ，在 调用栈 的任务执行完毕之后，系统会检查任务队列，看是否有可以执行的异步任务。</p> <p>注意：任务队列存放的是异步任务的事件回调</p> <p>例如上例：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'时间到'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在执行这段代码时，并不会立刻打印 ，只有定时结束后（1s）才打印。 setTimeout 本身是同步执行的，放入任务队列的是它的回调函数。</p> <p>下面我们重点看一下主线程上的调用栈。</p> <h2 id="四、调用栈"><a href="#四、调用栈" class="header-anchor">#</a> 四、调用栈</h2> <p>我们从以下两个方面介绍调用栈：</p> <ul><li>调用栈的用来做什么</li> <li>在开发中，如何利用调用栈</li></ul> <ol><li>调用栈的职责
我们知道，在 JavaScript 中有很多函数，经常会出现一个函数调用另外一个函数的情况，调用栈就是用来管理函数调用关系的一种栈结构 。</li></ol> <p>那么它是如何去管理函数调用关系喃？我们举例说明：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token number">3</span>
  <span class="token keyword">return</span> a <span class="token operator">+</span> b <span class="token operator">+</span> c
<span class="token punctuation">}</span>

<span class="token comment">// 函数调用</span>
<span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>这段代码很简单，就是创建了一个 add 函数，然后调用了它。
具体实现请参考<a href="https://github.com/sisterAn/JavaScript-Algorithms/issues/24" target="_blank" rel="noopener noreferrer">github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>调用栈是 JavaScript 用来管理函数执行上下文的一种数据结构，它记录了当前函数执行的位置，哪个函数正在被执行。 如果我们执行一个函数，就会为函数创建执行上下文并放入栈顶。 如果我们从函数返回，就将它的执行上下文从栈顶弹出。 也可以说调用栈是用来管理这种执行上下文的栈，或称执行上下文栈（执行栈）。</p> <ol start="2"><li>懂调用栈的开发人员有哪些优势</li></ol> <ul><li>栈溢出</li></ul> <p>我们知道调用栈是用来管理执行上下文的一种数据结构，它是有大小的，当入栈的上下文过多的时候，它就会报栈溢出，例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>add 函数不断的递归，不断的入栈，调用栈的容量有限，它就溢出了，所以，我们日常的开发中，一定要注意此类代码的出现。</p> <ul><li>在浏览器中获取调用栈信息</li></ul> <p>两种方式，一种是断点调试，这种很简单，我们日常开发中都用过。</p> <p>一种是 console.trace()</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token number">1</span>
<span class="token punctuation">}</span>

<span class="token comment">// 函数调用</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="五、js-内存机制-栈-基本类型、引言类型地址-与堆-引用类型数据"><a href="#五、js-内存机制-栈-基本类型、引言类型地址-与堆-引用类型数据" class="header-anchor">#</a> 五、JS 内存机制：栈（基本类型、引言类型地址）与堆（引用类型数据）</h2> <p>在 JavaScript 开发日常中，前端人员很少有机会了解内存，但如果你想成为前端的专家，打造高性能的前端应用，你就需要了解这一块，同时它也是面试的常见考察点。</p> <p>JavaScript 中的内存空间主要分为三种类型：</p> <ul><li>代码空间：主要用来存放可执行代码</li> <li>栈空间：调用栈的存储空间就是栈空间。</li> <li>堆空间</li></ul> <p>代码空间主要用来存放可执行代码的。栈空间及堆空间主要用来存放数据的。接下来我们主要介绍栈空间及堆空间。</p> <p>JavaScript 中的变量类型有 8 种，可分为两种：基本类型、引用类型。</p> <p>基本类型：</p> <ul><li>undefined</li> <li>null</li> <li>boolean</li> <li>number</li> <li>string</li> <li>bigint</li> <li>symbol</li></ul> <p>引用类型：</p> <ul><li>object</li></ul> <p>其中，基本类型是保存在栈内存中的简单数据段，而引用类型保存在堆内存中。</p> <ol><li>栈空间</li></ol> <p>基本类型在内存中占有固定大小的空间，所以它们的值保存在栈空间，我们通过 按值访问 。</p> <p>一般栈空间不会很大。</p> <ol start="2"><li>堆空间</li></ol> <p>引用类型，值大小不固定，但指向值的指针大小（内存地址）是固定的，所以把对象放入堆中，将对象的地址放入栈中，这样，在调用栈中切换上下文时，只需要将指针下移到上个执行上下文的地址就可以了，同时保证了栈空间不会很大。</p> <p>当查询引用类型的变量时， 先从栈中读取内存地址， 然后再通过地址找到堆中的值。对于这种，我们把它叫做 按引用访问 。</p> <p>一般堆内存空间很大，能存放很多数据，但它内存分配与回收都需要花费一定的时间。</p> <p>基本类型（栈空间）与引用类型（堆空间）的存储方式决定了：基本类型赋值是值赋值，而引用类型赋值是地址赋值。</p> <ol start="3"><li>垃圾回收</li></ol> <p>JavaScript 中的垃圾数据都是由垃圾回收器自动回收的，不需要手动释放。所以大部分的开发人员并不了解垃圾回收，但这部分也是前端进阶资深必备！</p> <p>回收栈空间</p> <p>在 JavaScript 执行代码时，主线程上会存在 ESP 指针，用来指向调用栈中当前正在执行的上下文,JavaScript 引擎通过向下移动 ESP 指针来销毁存放在栈空间中的执行上下文</p> <p>回收堆空间</p> <p>V8 中把堆分成新生代与老生代两个区域：</p> <ul><li>新生代：用来存放生存周期较短的小对象，一般只支持1～8M的容量</li> <li>老生代：用来存放生存周期较长的对象或大对象</li></ul> <p>V8 对这两块使用了不同的回收器：</p> <ul><li>新生代使用副垃圾回收器</li> <li>老生代使用主垃圾回收器</li></ul> <p>其实无论哪种垃圾回收器，都采用了同样的流程（三步走）：</p> <ul><li>标记： 标记堆空间中的活动对象（正在使用）与非活动对象（可回收）</li> <li>垃圾清理： 回收非活动对象所占用的内存空间</li> <li>内存整理： 当进行频繁的垃圾回收时，内存中可能存在大量不连续的内存碎片，当需要分配一个需要占用较大连续内存空间的对象时，可能存在内存不足的现象，所以，这时就需要整理这些内存碎片。</li></ul> <p>副垃圾回收器与主垃圾回收器虽然都采用同样的流程，但使用的回收策略与算法是不同的。</p> <p>增量标记</p> <p>V8 浏览器会自动执行垃圾回收，但由于 JavaScript 也是运行在主线程上的，一旦执行垃圾回收，就要打断 JavaScript 的运行，可能会或多或少的造成页面的卡顿，影响用户体验，所以 V8 决定采用增量 标记算法回收：</p> <p>即把垃圾回收拆成一个个小任务，穿插在 JavaScript 中执行。</p> <h2 id="六、总结"><a href="#六、总结" class="header-anchor">#</a> 六、总结</h2> <p>本节从栈结构开始介绍，满足后进先出 (LIFO) 原则的有序集合，然后通过数组实现了一个栈。</p> <p>接着介绍浏览器环境下 JavaScript 的异步执行机制，即事件循环机制， JavaScript 主线程不断的循环往复的从任务队列中读取任务（异步事件回调），放入调用栈中执行。调用栈又称执行上下文栈（执行栈），是用来管理函数执行上下文的栈结构。</p> <p>JavaScript 的存储机制分为代码空间、栈空间以及堆空间，代码空间用于存放可执行代码，栈空间用于存放基本类型数据和引用类型地址，堆空间用于存放引用类型数据，当调用栈中执行完成一个执行上下文时，需要进行垃圾回收该上下文以及相关数据空间，存放在栈空间上的数据通过 ESP 指针来回收，存放在堆空间的数据通过副垃圾回收器（新生代）与主垃圾回收器（老生代）来回收。</p> <p>聊聊就跑远了🤦‍♀️，但都是前端进阶必会，接下来我们开始刷栈题目吧！！！每日一刷，进阶前端与算法⛽️⛽️⛽️，来道简单的吧！</p> <h2 id="七、字节-leetcode155-最小栈-包含getmin函数的栈"><a href="#七、字节-leetcode155-最小栈-包含getmin函数的栈" class="header-anchor">#</a> 七、字节&amp;leetcode155：最小栈（包含getMin函数的栈）</h2> <p>设计一个支持 push ，pop ，top 操作，并能在常数时间内检索到最小元素的栈。</p> <p>push(x) —— 将元素 x 推入栈中。
pop() —— 删除栈顶的元素。
top() —— 获取栈顶元素。
getMin() —— 检索栈中的最小元素。
示例:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>MinStack minStack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MinStack</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
minStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
minStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
minStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
minStack<span class="token punctuation">.</span><span class="token function">getMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">--</span><span class="token operator">&gt;</span> 返回 <span class="token operator">-</span><span class="token number">3.</span>
minStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
minStack<span class="token punctuation">.</span><span class="token function">top</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token operator">--</span><span class="token operator">&gt;</span> 返回 <span class="token number">0.</span>
minStack<span class="token punctuation">.</span><span class="token function">getMin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token operator">--</span><span class="token operator">&gt;</span> 返回 <span class="token operator">-</span><span class="token number">2.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/18/2021, 2:37:47 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/notebook/algorithm/four.html" class="prev">
        链表
      </a></span> <span class="next"><a href="/notebook/algorithm/six.html">
        队列
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/notebook/assets/js/app.d5d280cf.js" defer></script><script src="/notebook/assets/js/2.c59ea2be.js" defer></script><script src="/notebook/assets/js/11.1ba6addf.js" defer></script>
  </body>
</html>
