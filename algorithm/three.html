<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>LRUç®—æ³• | NoteBook</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/notebook/logo.png">
    <meta name="description" content="my notebook --xy">
    
    <link rel="preload" href="/notebook/assets/css/0.styles.feb86cda.css" as="style"><link rel="preload" href="/notebook/assets/js/app.e4e3e469.js" as="script"><link rel="preload" href="/notebook/assets/js/2.c59ea2be.js" as="script"><link rel="preload" href="/notebook/assets/js/15.0da68e42.js" as="script"><link rel="prefetch" href="/notebook/assets/js/10.72515af1.js"><link rel="prefetch" href="/notebook/assets/js/11.bc8ad17c.js"><link rel="prefetch" href="/notebook/assets/js/12.7ce7b63f.js"><link rel="prefetch" href="/notebook/assets/js/13.986d128d.js"><link rel="prefetch" href="/notebook/assets/js/14.ec9584cf.js"><link rel="prefetch" href="/notebook/assets/js/16.f691159d.js"><link rel="prefetch" href="/notebook/assets/js/17.b59ce6bb.js"><link rel="prefetch" href="/notebook/assets/js/18.f559bc4f.js"><link rel="prefetch" href="/notebook/assets/js/19.c8f16af8.js"><link rel="prefetch" href="/notebook/assets/js/20.756dae28.js"><link rel="prefetch" href="/notebook/assets/js/21.e830f85f.js"><link rel="prefetch" href="/notebook/assets/js/22.63a71e21.js"><link rel="prefetch" href="/notebook/assets/js/23.fb7ad926.js"><link rel="prefetch" href="/notebook/assets/js/3.4a6b80a9.js"><link rel="prefetch" href="/notebook/assets/js/4.278935cc.js"><link rel="prefetch" href="/notebook/assets/js/5.d2a33903.js"><link rel="prefetch" href="/notebook/assets/js/6.ca28aea6.js"><link rel="prefetch" href="/notebook/assets/js/7.65771900.js"><link rel="prefetch" href="/notebook/assets/js/8.d71381e9.js"><link rel="prefetch" href="/notebook/assets/js/9.47008517.js">
    <link rel="stylesheet" href="/notebook/assets/css/0.styles.feb86cda.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notebook/" class="home-link router-link-active"><img src="/notebook/logo.png" alt="NoteBook" class="logo"> <span class="site-name can-hide">NoteBook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/notebook/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/notebook/algorithm/one.html" class="nav-link">
  Algorithm
</a></div><div class="nav-item"><a href="/notebook/browser/one.html" class="nav-link">
  Browser
</a></div><div class="nav-item"><a href="/notebook/vue/one.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/notebook/javascript/" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/notebook/css/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/notebook/network/one.html" class="nav-link">
  Network
</a></div><div class="nav-item"><a href="/notebook/tools/one.html" class="nav-link">
  å·¥ç¨‹åŒ–
</a></div><div class="nav-item"><a href="/notebook/others/" class="nav-link">
  å…¶ä»–
</a></div><div class="nav-item"><a href="https://github.com/HuaYuan92/notebook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/notebook/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/notebook/algorithm/one.html" class="nav-link">
  Algorithm
</a></div><div class="nav-item"><a href="/notebook/browser/one.html" class="nav-link">
  Browser
</a></div><div class="nav-item"><a href="/notebook/vue/one.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/notebook/javascript/" class="nav-link">
  JS
</a></div><div class="nav-item"><a href="/notebook/css/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/notebook/network/one.html" class="nav-link">
  Network
</a></div><div class="nav-item"><a href="/notebook/tools/one.html" class="nav-link">
  å·¥ç¨‹åŒ–
</a></div><div class="nav-item"><a href="/notebook/others/" class="nav-link">
  å…¶ä»–
</a></div><div class="nav-item"><a href="https://github.com/HuaYuan92/notebook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/notebook/algorithm/one.html" class="sidebar-link">å¤æ‚åº¦</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/algorithm/one.html#ä¸€ã€ä¸ºä»€ä¹ˆå¼•å…¥å¤æ‚åº¦åˆ†æ" class="sidebar-link">ä¸€ã€ä¸ºä»€ä¹ˆå¼•å…¥å¤æ‚åº¦åˆ†æ</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/one.html#äºŒã€å¦‚ä½•è¡¨ç¤ºå¤æ‚åº¦" class="sidebar-link">äºŒã€å¦‚ä½•è¡¨ç¤ºå¤æ‚åº¦</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/one.html#ä¸‰ã€æ—¶é—´å¤æ‚åº¦" class="sidebar-link">ä¸‰ã€æ—¶é—´å¤æ‚åº¦</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/one.html#å››ã€ç©ºé—´å¤æ‚åº¦" class="sidebar-link">å››ã€ç©ºé—´å¤æ‚åº¦</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/one.html#äº”ã€å¹³å‡æ—¶é—´å¤æ‚åº¦" class="sidebar-link">äº”ã€å¹³å‡æ—¶é—´å¤æ‚åº¦</a></li></ul></li><li><a href="/notebook/algorithm/two.html" class="sidebar-link">æ•°ç»„</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/algorithm/two.html#ä¸€ã€æ•°ç»„-åŸºç¡€" class="sidebar-link">ä¸€ã€æ•°ç»„ï¼ˆåŸºç¡€ï¼‰</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/two.html#äºŒã€javascript-ä¸­-æ•°ç»„å¯ä»¥ä¿å­˜ä¸åŒç±»å‹å€¼" class="sidebar-link">äºŒã€JavaScript ä¸­ï¼Œæ•°ç»„å¯ä»¥ä¿å­˜ä¸åŒç±»å‹å€¼</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/two.html#ä¸‰ã€javascript-ä¸­-æ•°ç»„çš„å­˜å‚¨" class="sidebar-link">ä¸‰ã€JavaScript ä¸­ï¼Œæ•°ç»„çš„å­˜å‚¨</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/two.html#å››ã€javascript-ä¸­-æ•°ç»„çš„åŠ¨æ€æ‰©å®¹ä¸å‡å®¹-fastelements" class="sidebar-link">å››ã€JavaScript ä¸­ï¼Œæ•°ç»„çš„åŠ¨æ€æ‰©å®¹ä¸å‡å®¹ï¼ˆFastElementsï¼‰</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/two.html#äº”ã€è§£ç­”å¼€ç¯‡é—®é¢˜" class="sidebar-link">äº”ã€è§£ç­”å¼€ç¯‡é—®é¢˜</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/two.html#å…­ã€æœ€åé™„èµ ä¸€é“å‰ç«¯é¢è¯•é¢˜-è…¾è®¯-æ•°ç»„æ‰å¹³åŒ–ã€å»é‡ã€æ’åº" class="sidebar-link">å…­ã€æœ€åé™„èµ ä¸€é“å‰ç«¯é¢è¯•é¢˜ï¼ˆè…¾è®¯ï¼‰ï¼šæ•°ç»„æ‰å¹³åŒ–ã€å»é‡ã€æ’åº</a></li></ul></li><li><a href="/notebook/algorithm/three.html" aria-current="page" class="active sidebar-link">LRUç®—æ³•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/algorithm/three.html#ä¸€ã€lru-ç¼“å­˜æ·˜æ±°ç­–ç•¥" class="sidebar-link">ä¸€ã€LRU ç¼“å­˜æ·˜æ±°ç­–ç•¥</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/three.html#äºŒã€lru-åœ¨-keep-alive-vue-ä¸Šçš„å®ç°" class="sidebar-link">äºŒã€LRU åœ¨ keep-alive (Vue) ä¸Šçš„å®ç°</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/three.html#ä¸‰ã€leetcode-lru-ç¼“å­˜æœºåˆ¶" class="sidebar-link">ä¸‰ã€leetcodeï¼šLRU ç¼“å­˜æœºåˆ¶</a></li></ul></li><li><a href="/notebook/algorithm/four.html" class="sidebar-link">é“¾è¡¨</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/algorithm/four.html#ä¸€ã€å•é“¾è¡¨" class="sidebar-link">ä¸€ã€å•é“¾è¡¨</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/four.html#äºŒã€åŒé“¾è¡¨" class="sidebar-link">äºŒã€åŒé“¾è¡¨</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/four.html#ä¸‰ã€å¾ªç¯å•é“¾è¡¨-å¾ªç¯åŒé“¾è¡¨" class="sidebar-link">ä¸‰ã€å¾ªç¯å•é“¾è¡¨/å¾ªç¯åŒé“¾è¡¨</a></li></ul></li><li><a href="/notebook/algorithm/five.html" class="sidebar-link">æ ˆã€å †ã€åƒåœ¾å›æ”¶ï¼‰</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#ä¸€ã€-æ ˆ" class="sidebar-link">ä¸€ã€ æ ˆ</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#äºŒã€ä»£ç å®ç°" class="sidebar-link">äºŒã€ä»£ç å®ç°</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#ä¸‰ã€æµè§ˆå™¨ä¸­-js-è¿è¡Œæœºåˆ¶" class="sidebar-link">ä¸‰ã€æµè§ˆå™¨ä¸­ JS è¿è¡Œæœºåˆ¶</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#å››ã€è°ƒç”¨æ ˆ" class="sidebar-link">å››ã€è°ƒç”¨æ ˆ</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#äº”ã€js-å†…å­˜æœºåˆ¶-æ ˆ-åŸºæœ¬ç±»å‹ã€å¼•è¨€ç±»å‹åœ°å€-ä¸å †-å¼•ç”¨ç±»å‹æ•°æ®" class="sidebar-link">äº”ã€JS å†…å­˜æœºåˆ¶ï¼šæ ˆï¼ˆåŸºæœ¬ç±»å‹ã€å¼•è¨€ç±»å‹åœ°å€ï¼‰ä¸å †ï¼ˆå¼•ç”¨ç±»å‹æ•°æ®ï¼‰</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#å…­ã€æ€»ç»“" class="sidebar-link">å…­ã€æ€»ç»“</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/five.html#ä¸ƒã€å­—èŠ‚-leetcode155-æœ€å°æ ˆ-åŒ…å«getminå‡½æ•°çš„æ ˆ" class="sidebar-link">ä¸ƒã€å­—èŠ‚&amp;leetcode155ï¼šæœ€å°æ ˆï¼ˆåŒ…å«getMinå‡½æ•°çš„æ ˆï¼‰</a></li></ul></li><li><a href="/notebook/algorithm/six.html" class="sidebar-link">é˜Ÿåˆ—</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/algorithm/six.html#ä¸€ã€æ•°æ®ç»“æ„-é˜Ÿåˆ—" class="sidebar-link">ä¸€ã€æ•°æ®ç»“æ„ï¼šé˜Ÿåˆ—</a></li><li class="sidebar-sub-header"><a href="/notebook/algorithm/six.html#äºŒã€åŒç«¯é˜Ÿåˆ—-deque" class="sidebar-link">äºŒã€åŒç«¯é˜Ÿåˆ—ï¼ˆDequeï¼‰</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="lruç®—æ³•"><a href="#lruç®—æ³•" class="header-anchor">#</a> LRUç®—æ³•</h1> <p><a href="https://github.com/sisterAn/JavaScript-Algorithms/issues/9" target="_blank" rel="noopener noreferrer">github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="ä¸€ã€lru-ç¼“å­˜æ·˜æ±°ç­–ç•¥"><a href="#ä¸€ã€lru-ç¼“å­˜æ·˜æ±°ç­–ç•¥" class="header-anchor">#</a> ä¸€ã€LRU ç¼“å­˜æ·˜æ±°ç­–ç•¥</h2> <p>ç¼“å­˜åœ¨è®¡ç®—æœºç½‘ç»œä¸Šéšå¤„å¯è§ï¼Œä¾‹å¦‚ï¼šå½“æˆ‘ä»¬é¦–æ¬¡è®¿é—®ä¸€ä¸ªç½‘é¡µæ—¶ï¼Œæ‰“å¼€å¾ˆæ…¢ï¼Œä½†å½“æˆ‘ä»¬å†æ¬¡æ‰“å¼€è¿™ä¸ªç½‘é¡µæ—¶ï¼Œæ‰“å¼€å°±å¾ˆå¿«ã€‚</p> <p>è¿™å°±æ¶‰åŠç¼“å­˜åœ¨æµè§ˆå™¨ä¸Šçš„åº”ç”¨ï¼šæµè§ˆå™¨ç¼“å­˜ã€‚å½“æˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªç½‘é¡µæ—¶ï¼Œä¾‹å¦‚ https://github.com/sisterAn/JavaScript-Algorithms ï¼Œå®ƒä¼šåœ¨å‘èµ·çœŸæ­£çš„ç½‘ç»œè¯·æ±‚å‰ï¼ŒæŸ¥è¯¢æµè§ˆå™¨ç¼“å­˜ï¼Œçœ‹æ˜¯å¦æœ‰è¦è¯·æ±‚çš„æ–‡ä»¶ï¼Œå¦‚æœæœ‰ï¼Œæµè§ˆå™¨å°†ä¼šæ‹¦æˆªè¯·æ±‚ï¼Œè¿”å›ç¼“å­˜æ–‡ä»¶ï¼Œå¹¶ç›´æ¥ç»“æŸè¯·æ±‚ï¼Œä¸ä¼šå†å»æœåŠ¡å™¨ä¸Šä¸‹è½½ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œæ‰ä¼šå»æœåŠ¡å™¨è¯·æ±‚ã€‚</p> <p>å…¶å®ï¼Œæµè§ˆå™¨ä¸­çš„ç¼“å­˜æ˜¯ä¸€ç§åœ¨æœ¬åœ°ä¿å­˜èµ„æºå‰¯æœ¬ï¼Œå®ƒçš„å¤§å°æ˜¯æœ‰é™çš„ï¼Œå½“æˆ‘ä»¬è¯·æ±‚æ•°è¿‡å¤šæ—¶ï¼Œç¼“å­˜ç©ºé—´ä¼šè¢«ç”¨æ»¡ï¼Œæ­¤æ—¶ï¼Œç»§ç»­è¿›è¡Œç½‘ç»œè¯·æ±‚å°±éœ€è¦ç¡®å®šç¼“å­˜ä¸­å“ªäº›æ•°æ®è¢«ä¿ç•™ï¼Œå“ªäº›æ•°æ®è¢«ç§»é™¤ï¼Œè¿™å°±æ˜¯æµè§ˆå™¨ç¼“å­˜æ·˜æ±°ç­–ç•¥ï¼Œæœ€å¸¸è§çš„æ·˜æ±°ç­–ç•¥æœ‰ FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ã€LFUï¼ˆæœ€å°‘ä½¿ç”¨ï¼‰ã€LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ã€‚</p> <p>LRU ï¼ˆ Least Recently Used ï¼šæœ€è¿‘æœ€å°‘ä½¿ç”¨ ï¼‰ç¼“å­˜æ·˜æ±°ç­–ç•¥ï¼Œæ•…åæ€ä¹‰ï¼Œå°±æ˜¯æ ¹æ®æ•°æ®çš„å†å²è®¿é—®è®°å½•æ¥è¿›è¡Œæ·˜æ±°æ•°æ®ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯ å¦‚æœæ•°æ®æœ€è¿‘è¢«è®¿é—®è¿‡ï¼Œé‚£ä¹ˆå°†æ¥è¢«è®¿é—®çš„å‡ ç‡ä¹Ÿæ›´é«˜ ï¼Œä¼˜å…ˆæ·˜æ±°æœ€è¿‘æ²¡æœ‰è¢«è®¿é—®åˆ°çš„æ•°æ®ã€‚</p> <h2 id="äºŒã€lru-åœ¨-keep-alive-vue-ä¸Šçš„å®ç°"><a href="#äºŒã€lru-åœ¨-keep-alive-vue-ä¸Šçš„å®ç°" class="header-anchor">#</a> äºŒã€LRU åœ¨ keep-alive (Vue) ä¸Šçš„å®ç°</h2> <ol><li>keep-alive
keep-alive åœ¨ vue ä¸­ç”¨äºå®ç°ç»„ä»¶çš„ç¼“å­˜ï¼Œå½“ç»„ä»¶åˆ‡æ¢æ—¶ä¸ä¼šå¯¹å½“å‰ç»„ä»¶è¿›è¡Œå¸è½½ã€‚</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> åŸºæœ¬ <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>keep<span class="token operator">-</span>alive<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>component is<span class="token operator">=</span><span class="token string">&quot;view&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>component<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>keep<span class="token operator">-</span>alive<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>æœ€å¸¸ç”¨çš„ä¸¤ä¸ªå±æ€§ï¼šinclude ã€ exculde ï¼Œç”¨äºç»„ä»¶è¿›è¡Œæœ‰æ¡ä»¶çš„ç¼“å­˜ï¼Œå¯ä»¥ç”¨é€—å·åˆ†éš”å­—ç¬¦ä¸²ã€æ­£åˆ™è¡¨è¾¾å¼æˆ–ä¸€ä¸ªæ•°ç»„æ¥è¡¨ç¤ºã€‚</p> <p>åœ¨ 2.5.0 ç‰ˆæœ¬ä¸­ï¼Œkeep-alive æ–°å¢äº† max å±æ€§ï¼Œç”¨äºæœ€å¤šå¯ä»¥ç¼“å­˜å¤šå°‘ç»„ä»¶å®ä¾‹ï¼Œä¸€æ—¦è¿™ä¸ªæ•°å­—è¾¾åˆ°äº†ï¼Œåœ¨æ–°å®ä¾‹è¢«åˆ›å»ºä¹‹å‰ï¼Œå·²ç¼“å­˜ç»„ä»¶ä¸­æœ€ä¹…æ²¡æœ‰è¢«è®¿é—®çš„å®ä¾‹ä¼šè¢«é”€æ¯æ‰ï¼Œçœ‹ï¼Œè¿™é‡Œå°±åº”ç”¨äº† LRU ç®—æ³•ã€‚å³åœ¨ keep-alive ä¸­ç¼“å­˜è¾¾åˆ° maxï¼Œæ–°å¢ç¼“å­˜å®ä¾‹ä¼šä¼˜å…ˆæ·˜æ±°æœ€è¿‘æ²¡æœ‰è¢«è®¿é—®åˆ°çš„å®ä¾‹ğŸ‰ğŸ‰ğŸ‰</p> <p>ä¸‹é¢æˆ‘ä»¬é€è¿‡ vue æºç çœ‹ä¸€ä¸‹å…·ä½“çš„å®ç°ğŸ‘‡</p> <ol start="2"><li>ä» vue æºç çœ‹ keep-alive çš„å®ç°</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;keep-alive&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// æŠ½è±¡ç»„ä»¶å±æ€§ ,å®ƒåœ¨ç»„ä»¶å®ä¾‹å»ºç«‹çˆ¶å­å…³ç³»çš„æ—¶å€™ä¼šè¢«å¿½ç•¥,å‘ç”Ÿåœ¨ initLifecycle çš„è¿‡ç¨‹ä¸­</span>
  abstract<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> 
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¢«ç¼“å­˜ç»„ä»¶</span>
    include<span class="token operator">:</span> patternTypes<span class="token punctuation">,</span> 
    <span class="token comment">// ä¸è¢«ç¼“å­˜ç»„ä»¶</span>
    exclude<span class="token operator">:</span> patternTypes<span class="token punctuation">,</span>
    <span class="token comment">// æŒ‡å®šç¼“å­˜å¤§å°</span>
    max<span class="token operator">:</span> <span class="token punctuation">[</span>String<span class="token punctuation">,</span> Number<span class="token punctuation">]</span> 
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆå§‹åŒ–ç”¨äºå­˜å‚¨ç¼“å­˜çš„ cache å¯¹è±¡</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cache <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// åˆå§‹åŒ–ç”¨äºå­˜å‚¨VNode keyå€¼çš„ keys æ•°ç»„</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">destroyed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// åˆ é™¤æ‰€æœ‰ç¼“å­˜</span>
      <span class="token function">pruneCacheEntry</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keys<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ç›‘å¬ç¼“å­˜ï¼ˆincludeï¼‰/ä¸ç¼“å­˜ï¼ˆexcludeï¼‰ç»„ä»¶çš„å˜åŒ–</span>
    <span class="token comment">// åœ¨å˜åŒ–æ—¶ï¼Œé‡æ–°è°ƒæ•´ cache</span>
    <span class="token comment">// pruneCacheï¼šéå† cacheï¼Œå¦‚æœç¼“å­˜çš„èŠ‚ç‚¹åç§°ä¸ä¼ å…¥çš„è§„åˆ™æ²¡æœ‰åŒ¹é…ä¸Šçš„è¯ï¼Œå°±æŠŠè¿™ä¸ªèŠ‚ç‚¹ä»ç¼“å­˜ä¸­ç§»é™¤</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token string">&quot;include&quot;</span><span class="token punctuation">,</span> <span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">pruneCache</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token parameter">name</span> <span class="token operator">=&gt;</span> <span class="token function">matches</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span><span class="token string">&quot;exclude&quot;</span><span class="token punctuation">,</span> <span class="token parameter">val</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">pruneCache</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token parameter">name</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span><span class="token function">matches</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è·å–ç¬¬ä¸€ä¸ªå­å…ƒç´ çš„ vnode</span>
    <span class="token keyword">const</span> slot <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$slots<span class="token punctuation">.</span>default<span class="token punctuation">;</span>
    <span class="token keyword">const</span> vnode<span class="token operator">:</span> VNode <span class="token operator">=</span> <span class="token function">getFirstComponentChild</span><span class="token punctuation">(</span>slot<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> componentOptions<span class="token operator">:</span> <span class="token operator">?</span>VNodeComponentOptions <span class="token operator">=</span>
      vnode <span class="token operator">&amp;&amp;</span> vnode<span class="token punctuation">.</span>componentOptions<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>componentOptions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// name ä¸åœ¨ inlcude ä¸­æˆ–è€…åœ¨ exlude ä¸­åˆ™ç›´æ¥è¿”å› vnodeï¼Œå¦åˆ™ç»§ç»­è¿›è¡Œä¸‹ä¸€æ­¥</span>
      <span class="token comment">// check pattern</span>
      <span class="token keyword">const</span> name<span class="token operator">:</span> <span class="token operator">?</span>string <span class="token operator">=</span> <span class="token function">getComponentName</span><span class="token punctuation">(</span>componentOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> include<span class="token punctuation">,</span> exclude <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>
        <span class="token comment">// not included</span>
        <span class="token punctuation">(</span>include <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span>name <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">matches</span><span class="token punctuation">(</span>include<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
        <span class="token comment">// excluded</span>
        <span class="token punctuation">(</span>exclude <span class="token operator">&amp;&amp;</span> name <span class="token operator">&amp;&amp;</span> <span class="token function">matches</span><span class="token punctuation">(</span>exclude<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> vnode<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      
      <span class="token keyword">const</span> <span class="token punctuation">{</span> cache<span class="token punctuation">,</span> keys <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      <span class="token comment">// è·å–é”®ï¼Œä¼˜å…ˆè·å–ç»„ä»¶çš„ name å­—æ®µï¼Œå¦åˆ™æ˜¯ç»„ä»¶çš„ tag</span>
      <span class="token keyword">const</span> key<span class="token operator">:</span> <span class="token operator">?</span>string <span class="token operator">=</span>
        vnode<span class="token punctuation">.</span>key <span class="token operator">==</span> <span class="token keyword">null</span>
          <span class="token operator">?</span> <span class="token comment">// same constructor may get registered as different local components</span>
            <span class="token comment">// so cid alone is not enough (#3269)</span>
            componentOptions<span class="token punctuation">.</span>Ctor<span class="token punctuation">.</span>cid <span class="token operator">+</span>
            <span class="token punctuation">(</span>componentOptions<span class="token punctuation">.</span>tag <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">::</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>componentOptions<span class="token punctuation">.</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
          <span class="token operator">:</span> vnode<span class="token punctuation">.</span>key<span class="token punctuation">;</span>
        
      <span class="token comment">// --------------------------------------------------</span>
      <span class="token comment">// ä¸‹é¢å°±æ˜¯ LRU ç®—æ³•äº†ï¼Œ</span>
      <span class="token comment">// å¦‚æœåœ¨ç¼“å­˜é‡Œæœ‰åˆ™è°ƒæ•´ï¼Œ</span>
      <span class="token comment">// æ²¡æœ‰åˆ™æ”¾å…¥ï¼ˆé•¿åº¦è¶…è¿‡ maxï¼Œåˆ™æ·˜æ±°æœ€è¿‘æ²¡æœ‰è®¿é—®çš„ï¼‰</span>
      <span class="token comment">// --------------------------------------------------</span>
      <span class="token comment">// å¦‚æœå‘½ä¸­ç¼“å­˜ï¼Œåˆ™ä»ç¼“å­˜ä¸­è·å– vnode çš„ç»„ä»¶å®ä¾‹ï¼Œå¹¶ä¸”è°ƒæ•´ key çš„é¡ºåºæ”¾å…¥ keys æ•°ç»„çš„æœ«å°¾</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vnode<span class="token punctuation">.</span>componentInstance <span class="token operator">=</span> cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>componentInstance<span class="token punctuation">;</span>
        <span class="token comment">// make current key freshest</span>
        <span class="token function">remove</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// å¦‚æœæ²¡æœ‰å‘½ä¸­ç¼“å­˜,å°±æŠŠ vnode æ”¾è¿›ç¼“å­˜</span>
      <span class="token keyword">else</span> <span class="token punctuation">{</span>
        cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> vnode<span class="token punctuation">;</span>
        keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// prune oldest entry</span>
        <span class="token comment">// å¦‚æœé…ç½®äº† max å¹¶ä¸”ç¼“å­˜çš„é•¿åº¦è¶…è¿‡äº† this.maxï¼Œè¿˜è¦ä»ç¼“å­˜ä¸­åˆ é™¤ç¬¬ä¸€ä¸ª</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>max <span class="token operator">&amp;&amp;</span> keys<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>max<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">pruneCacheEntry</span><span class="token punctuation">(</span>cache<span class="token punctuation">,</span> keys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> keys<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_vnode<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      
      <span class="token comment">// keepAliveæ ‡è®°ä½</span>
      vnode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>keepAlive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> vnode <span class="token operator">||</span> <span class="token punctuation">(</span>slot <span class="token operator">&amp;&amp;</span> slot<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// ç§»é™¤ key ç¼“å­˜</span>
<span class="token keyword">function</span> <span class="token function">pruneCacheEntry</span> <span class="token punctuation">(</span>
  <span class="token parameter">cache<span class="token operator">:</span> VNodeCache<span class="token punctuation">,</span>
  key<span class="token operator">:</span> string<span class="token punctuation">,</span>
  keys<span class="token operator">:</span> Array<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">,</span>
  current<span class="token operator">?</span><span class="token operator">:</span> VNode</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cached <span class="token operator">=</span> cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cached <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span>current <span class="token operator">||</span> cached<span class="token punctuation">.</span>tag <span class="token operator">!==</span> current<span class="token punctuation">.</span>tag<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cached<span class="token punctuation">.</span>componentInstance<span class="token punctuation">.</span><span class="token function">$destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token function">remove</span><span class="token punctuation">(</span>keys<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// remove æ–¹æ³•ï¼ˆshared/util.jsï¼‰</span>
<span class="token comment">/**
 * Remove an item from an array.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">remove</span> <span class="token punctuation">(</span><span class="token parameter">arr<span class="token operator">:</span> Array<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span><span class="token punctuation">,</span> item<span class="token operator">:</span> any</span><span class="token punctuation">)</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span> <span class="token operator">|</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> index <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br></div></div><p>åœ¨ keep-alive ç¼“å­˜è¶…è¿‡ max æ—¶ï¼Œä½¿ç”¨çš„ç¼“å­˜æ·˜æ±°ç®—æ³•å°±æ˜¯ LRU ç®—æ³•ï¼Œå®ƒåœ¨å®ç°çš„è¿‡ç¨‹ä¸­ç”¨åˆ°äº† cache å¯¹è±¡ç”¨äºä¿å­˜ç¼“å­˜çš„ç»„ä»¶å®ä¾‹åŠ key å€¼ï¼Œkeys æ•°ç»„ç”¨äºä¿å­˜ç¼“å­˜ç»„ä»¶çš„ key ï¼Œå½“ keep-alive ä¸­æ¸²æŸ“ä¸€ä¸ªéœ€è¦ç¼“å­˜çš„å®ä¾‹æ—¶ï¼š</p> <p>åˆ¤æ–­ç¼“å­˜ä¸­æ˜¯å¦å·²ç¼“å­˜äº†è¯¥å®ä¾‹ï¼Œç¼“å­˜äº†åˆ™ç›´æ¥è·å–ï¼Œå¹¶è°ƒæ•´ key åœ¨ keys ä¸­çš„ä½ç½®ï¼ˆç§»é™¤ keys ä¸­ key ï¼Œå¹¶æ”¾å…¥ keys æ•°ç»„çš„æœ€åä¸€ä½ï¼‰
å¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œåˆ™ç¼“å­˜è¯¥å®ä¾‹ï¼Œè‹¥ keys çš„é•¿åº¦å¤§äº max ï¼ˆç¼“å­˜é•¿åº¦è¶…è¿‡ä¸Šé™ï¼‰ï¼Œåˆ™ç§»é™¤ keys[0] ç¼“å­˜
ä¸‹é¢æˆ‘ä»¬æ¥è‡ªå·±å®ç°ä¸€ä¸ª LRU ç®—æ³•å§</p> <h2 id="ä¸‰ã€leetcode-lru-ç¼“å­˜æœºåˆ¶"><a href="#ä¸‰ã€leetcode-lru-ç¼“å­˜æœºåˆ¶" class="header-anchor">#</a> ä¸‰ã€leetcodeï¼šLRU ç¼“å­˜æœºåˆ¶</h2> <p>è¿ç”¨ä½ æ‰€æŒæ¡çš„æ•°æ®ç»“æ„ï¼Œè®¾è®¡å’Œå®ç°ä¸€ä¸ª LRU (æœ€è¿‘æœ€å°‘ä½¿ç”¨) ç¼“å­˜æœºåˆ¶ã€‚å®ƒåº”è¯¥æ”¯æŒä»¥ä¸‹æ“ä½œï¼š è·å–æ•°æ® get å’Œå†™å…¥æ•°æ® put ã€‚</p> <p>è·å–æ•°æ® get(key) - å¦‚æœå¯†é’¥ ( key ) å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œåˆ™è·å–å¯†é’¥çš„å€¼ï¼ˆæ€»æ˜¯æ­£æ•°ï¼‰ï¼Œå¦åˆ™è¿”å› -1 ã€‚
å†™å…¥æ•°æ® put(key, value) - å¦‚æœå¯†é’¥ä¸å­˜åœ¨ï¼Œåˆ™å†™å…¥æ•°æ®ã€‚å½“ç¼“å­˜å®¹é‡è¾¾åˆ°ä¸Šé™æ—¶ï¼Œå®ƒåº”è¯¥åœ¨å†™å…¥æ–°æ•°æ®ä¹‹å‰åˆ é™¤æœ€ä¹…æœªä½¿ç”¨çš„æ•°æ®ï¼Œä»è€Œä¸ºæ–°æ•°æ®ç•™å‡ºç©ºé—´ã€‚</p> <p>è¿›é˜¶:</p> <p>ä½ æ˜¯å¦å¯ä»¥åœ¨ O(1) æ—¶é—´å¤æ‚åº¦å†…å®Œæˆè¿™ä¸¤ç§æ“ä½œï¼Ÿ</p> <p>ç¤ºä¾‹:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>LRUCache cache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LRUCache</span><span class="token punctuation">(</span> <span class="token number">2</span> <span class="token comment">/* ç¼“å­˜å®¹é‡ */</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// è¿”å›  1</span>
cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è¯¥æ“ä½œä¼šä½¿å¾—å¯†é’¥ 2 ä½œåºŸ</span>
cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// è¿”å› -1 (æœªæ‰¾åˆ°)</span>
cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// è¯¥æ“ä½œä¼šä½¿å¾—å¯†é’¥ 1 ä½œåºŸ</span>
cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// è¿”å› -1 (æœªæ‰¾åˆ°)</span>
cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// è¿”å›  3</span>
cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// è¿”å›  4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>å‰é¢å·²ç»ä»‹ç»è¿‡äº† keep-alive ä¸­LRUå®ç°æºç ï¼Œç°åœ¨æ¥çœ‹è¿™é“é¢˜æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œå¯ä»¥å°è¯•è‡ªå·±è§£ç­”ä¸€ä¸‹ï¼Œç„¶åæ€è€ƒä¸€ä¸‹æœ‰æ²¡æœ‰ä»€ä¹ˆç»§ç»­ä¼˜åŒ–çš„ï¼æ¬¢è¿æä¾›æ›´å¤šçš„è§£æ³•</p> <p>ç­”æ¡ˆå·²æäº¤åˆ° <a href="https://github.com/sisterAn/JavaScript-Algorithms/issues/7" target="_blank" rel="noopener noreferrer">#7<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/18/2021, 2:37:47 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/notebook/algorithm/two.html" class="prev">
        æ•°ç»„
      </a></span> <span class="next"><a href="/notebook/algorithm/four.html">
        é“¾è¡¨
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/notebook/assets/js/app.e4e3e469.js" defer></script><script src="/notebook/assets/js/2.c59ea2be.js" defer></script><script src="/notebook/assets/js/15.0da68e42.js" defer></script>
  </body>
</html>
